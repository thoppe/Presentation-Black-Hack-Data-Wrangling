<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Black Hat Data Wrangling</title>
    
    <meta name="description" content="">
    <meta name="author" content="Travis Hoppe & Robert Dempsey">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" 
	  content="black-translucent" />

    <meta name="viewport" content="width=device-width, 
				   initial-scale=1.0, 
				   maximum-scale=1.0, 
				   user-scalable=no">

    <link rel="stylesheet" href="reveal.js/css/reveal.css">

    <!-- Default themes -->
    <link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
    <link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

    <!-- For LaTeX formating highlighting -->
    <link rel="stylesheet" href="md2reveal/css/md2reveal_style.css">

    <!--[if lt IE 9]>
	<script src="reveal.js/lib/js/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>

    <div class="reveal"><div class="slides">
	<section class="vertical-stack">
<section   class="vertical-slide">
<p>
</p>
<br>
<p>
<h1>Black Hat</h1><h1>Data Wrangling</h1></p>
<hr>
<p>
<h3><a href="http://thoppe.github.io/">Travis Hoppe</a> / <a href="http://robertwdempsey.com/about-robert-dempsey/">Robert Dempsey</a></h3><a href="https://twitter.com/metasemantic">@metasemantic</a> / <a href="https://twitter.com/rdempsey">@rdempsey</a></p>
<br>
<p>
<div class="reference_footnote"><a href="http://thoppe.github.io/Presentation-Black-Hack-Data-Wrangling">http://thoppe.github.io/Presentation-Black-Hack-Data-Wrangling</a></div><br><style>.whitehat {background:#333333;padding-bottom:0px !important;}</style></p>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h1>Data Wranglers</h1><h2>Want your data!</h2></p>
<br>
<figure>
    <a href="images/data_ST.gif">
    <img class="" src="images/data_ST.gif" height="300px">
    </a>
    
    </figure>
<figure>
    <a href="images/fast_type.gif">
    <img class="" src="images/fast_type.gif" height="300px">
    </a>
    
    </figure>
<br>
<p>
<h2>How can you <strong><strike>stop</strike></strong> slow them?</h2></p>
</section><section   class="vertical-slide">
<p>
<h2>White-hat data wrangler</h2>Working hard to make your data <strong>accessible</strong> to others.</p>
<figure>
    <a href="images/dcdw_logo.jpg">
    <img class="transparent_image" src="images/dcdw_logo.jpg" height="200px">
    </a>
    
    </figure>
<figure>
    <a href="images/DSDC_logo.png">
    <img class="transparent_image" src="images/DSDC_logo.png" height="200px">
    </a>
    
    </figure>
<figure>
    <a href="images/nyc_dw_logo.png">
    <img class="transparent_image" src="images/nyc_dw_logo.png" height="200px">
    </a>
    
    </figure>
<br>
<br>
<br>
<br>
<p>
<em>But what if you don't want people to have your data...?</em></p>
</section><section   class="vertical-slide">
<p>
<h2>Black-hat data wrangler</h2>Working hard to make your data as <strong>inaccessible</strong> as possible.</p>
<br>
<figure>
    <a href="images/evil_mrburns.png">
    <img class="transparent_image" src="images/evil_mrburns.png" height="200px">
    </a>
    
    </figure>
<figure>
    <a href="images/evil_cards.jpg">
    <img class="transparent_image" src="images/evil_cards.jpg" height="200px">
    </a>
    
    </figure>
<figure>
    <a href="images/evil_umbrella2.png">
    <img class="transparent_image" src="images/evil_umbrella2.png" height="200px">
    </a>
    
    </figure>
<br>
<br>
<p>
What kind of data?</p>
<br>
<p>
<em>Corporate finance / Political Donations / Regulations /</em><br><em> Anti-FOIA / Digital Marketer / ...</em></p>
</section><section   class="vertical-slide">
<p>
<h2>Why not disconnect from the net?</h2></p>
<br>
<br>
<figure>
    <a href="images/drevil2.jpg">
    <img class="" src="images/drevil2.jpg" height="300px">
    </a>
    
    </figure>
<figure>
    <a href="images/drevil.jpg">
    <img class="" src="images/drevil.jpg" height="300px">
    </a>
    
    </figure>
<figure>
    <a href="images/drevil3.jpg">
    <img class="" src="images/drevil3.jpg" height="300px">
    </a>
    
    </figure>
</section><section   class="vertical-slide">
<p>
<h1>When do you need a</h1><h2><em>Black Hack Data Wrangler?</em></h2></p>
<br>
<p>
<h3>You have a <strong>large</strong> amount of data</h3><h3>The data must be made <strong>public</strong></h3><h3>Should be human readable but <strong>computer-unfriendly</strong></h3><h3>Your actions should be <strong>hidden</strong> to a casual user</h3></p>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h3>Presentation format</h3><h5>Hack quantification</h5></p>
<br>
<p>
implementation : <strong>EASY</strong> : <strong>MEDIUM</strong> : <strong>HARD</strong> : <strong>WTF</strong></p>
<br>
<p>
defense : <strong>WEAK</strong> : <strong>REASONABLE</strong> : <strong>STRONG</strong> : <strong>RIDICULOUS</strong></p>
<br>
<p>
hack-level : <strong>SCRIPT-KIDDIE</strong> : <strong>CORPORATE</strong> : <strong>HOLLYWOOD</strong></p>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h3>Table of Contents</h3></p>
<br>
<p>
<h4><a href="#Hack1">Disable right-click</a> [T]</h4><h4><a href="#Hack2">Minification</a> [R]</h4><h4><a href="#Hack3">Authentication</a> [T]</h4><h4><a href="#Hack4">Data Limits</a> [R]</h4><h4><a href="#Hack5">Rendering to Images</a> [R]</h4><h4><a href="#Hack6">JavaScript page links</a> [T]</h4><h4><a href="#Hack7">Watermarking</a> [R, partially drafted, missing WH]</h4><h4><a href="#Hack8">Honeypots & Stenography</a> [T]</h4><h4><a href="#Hack9">Remove markup metadata</a> [T]</h4><h4><a href="#Hack10">HTML obfuscation</a> [R]</h4><h4><a href="#Hack11">Serving HTML as PDF</a> [R]</h4><h4><a href="#Hack12">Text remapping</a> [T, missing WH]</h4></p>
</section>
</section><section class="vertical-stack">
<section id="Hack1"  class="vertical-slide">
<p>
<h2><code>BlackHat1</code>: Disable right-click</h2>implementation <strong>EASY</strong> : defense <strong>WEAK</strong> : hack-level <strong>SCRIPT-KIDDIE</strong></p>
<br>
<pre><code class=python>&lt;script language=&quot;javascript&quot;&gt;
document.onmousedown=disableclick;
status=&quot;Right Click Disabled&quot;;
function disableclick(event) {
  if(event.button==2) {
     alert(status);
     return false;    
} }
&lt;/script&gt;</code></pre>
<br>
<p>
Also in this category, CSS overlays.</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat1</code>: Disable right-click </div></h2></p>
<br>
<p>
<h3>Open developers console (F12), search for <code>disableclick</code> and remove.</h3></p>
<br>
<p>
<h3>Turn of javascript.</h3></p>
<br>
<p>
<h3>Use a headless (or mobile) browser.</h3></p>
</section>
</section><section class="vertical-stack">
<section id="Hack2"  class="vertical-slide">
<p>
<h2><code>BlackHat2</code>: Minification</h2>implementation <strong>EASY</strong> : defense <strong>WEAK</strong> : hack-level <strong>SCRIPT-KIDDIE</strong></p>
<br>
<p>
<a href="https://github.com/kangax/html-minifier">Kangax HTML Minifier</a>: removes comments, whitespace, empty elements, and much more. Also minifies javascript and CSS.</p>
<br>
<p>
Ruby wrapper: <a href="https://github.com/stereobooster/html_minifier">html_minifier</a></p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat2</code>: Minification </div></h2>De-minify the HTML using freely available tools.</p>
<br>
<p>
Online tools: <a href="http://unminify.com/">Unminify</a>, <a href="">JS Beautifier</a><br><em>or</em><br>Text editor: <a href="https://github.com/welovewordpress/SublimeHtmlTidy">HTML Tidy</a> (Sublime Text)<br><em>or</em><br>Automate it: <a href="https://github.com/beautify-web/js-beautify">JS Beautifier</a></p>
<pre><code class=python>$ pip install jsbeautifier
$ js-beautify file.js</code></pre>
</section>
</section><section class="vertical-stack">
<section id="Hack3"  class="vertical-slide">
<p>
<h2><code>BlackHat3</code>: Authentication</h2>implementation <strong>MEDIUM</strong> : defense <strong>REASONABLE</strong> : hack-level <strong>CORPORATE</strong></p>
<br>
<p>
<h4>not RESTful?</h4>Implement visitor control via <code>$SESSIONS</code>. Give every new visitor to the site a unique ID that you control and limit access with. Bonus, restrict user-agent.</p>
<br>
<p>
<h4>REST API?</h4>Require all meaningful data requests to go through OAuth2, cumbersome for new-comers and direct control over the data distribution.</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat3</code>: Authentication </div></h2></p>
<br>
<p>
Create session ID's with headless browsers<br><em>and</em><br>simulate user-agents</p>
<br>
<p>
Poorly designed session states (that don't clear and hold<br>large internal variables) can DoS your server!</p>
</section>
</section><section class="vertical-stack">
<section id="Hack4"  class="vertical-slide">
<p>
<h2><code>BlackHat4:</code> Data & time limits</h2>implementation <strong>MEDIUM</strong> : defense <strong>REASONABLE</strong> : hack-level <strong>CORPORATE</strong></p>
<br>
<p>
Detection: high download rates or unusual traffic within a given timespan;<br>all traffic from a single client or IP address.</p>
<br>
<p>
Rate limit individual IP addresses or a specific id.<br>Delay content delivery.<br>Return HTTP 301, 40x or 50x errors (<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">full list</a>)</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat4</code>: Data & time limits </div></h2></p>
<br>
<p>
Frequently change your IP address using <a href="http://robertwdempsey.com/hma">VPN/proxy services</a> or <a href="https://www.torproject.org/">TOR</a>.<br><em>and</em><br>Slow down your scraper: Scrapy <a href="http://doc.scrapy.org/en/latest/topics/autothrottle.html">autothrottle</a>, custom timing code<br><em>and</em><br>Change your user agent: Scrapy <a href="https://github.com/cnu/scrapy-random-useragent">random user agent</a>, <a href="http://stackoverflow.com/questions/24226781/changing-user-agent-in-python-3-for-urrlib-urlopen">custom Python code</a></p>
</section>
</section><section class="vertical-stack">
<section id="Hack5"  class="vertical-slide">
<p>
<h2><code>BlackHat5</code>: Rendering to images</h2>implementation <strong>MEDIUM</strong> : defense <strong>STRONG</strong> : hack-level <strong>CORPORATE</strong></p>
<br>
<p>
<h3>Text to Image</h3><a href="https://www.daftlogic.com/projects-text-to-image.htm">PHP Text to Image</a> / <a href="http://www.imagemagick.org/script/index.php">ImageMagick</a><br><em>or</em><br>Draw text onto an HTML5 canvas using <a href="http://jsfiddle.net/JUWrV/">JavaScript</a> / use the HTML5 <a href="http://stackoverflow.com/questions/27552969/convert-text-to-canvas-image-preserving-formatting">canvasElement.toDataURL</a> element</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat5</code>: Rendering to images </div></h2></p>
<br>
<p>
Server or desktop-based OCR software<br><em>or</em><br>Adobe Acrobat: Image -> PDF -> OCR (manual)<br><em>or</em><br>Python: <a href="https://github.com/tmbdev/ocropy">OCRopus</a><br><em>or</em><br><a href="https://github.com/tesseract-ocr/tesseract">Tesseract Open Source OCR Engine</a></p>
</section>
</section><section class="vertical-stack">
<section id="Hack6"  class="vertical-slide">
<p>
<h2><code>BlackHat6</code>: JavaScript page links</h2>implementation <strong>MEDIUM</strong> : defense <strong>REASONABLE</strong> : hack-level <strong>CORPORATE</strong><br>Infinite pagination/scroll. Ex. <a href="https://dribbble.com/">Dribble</a></p>
<figure>
    <a href="images/infinite_scroll.gif">
    <img class="" src="images/infinite_scroll.gif" height="300px">
    </a>
    
    </figure>
<br>
<p>
Forces the user to simulate AJAX (stops headless browsers).<br><em>Combine with user sessions and data limits!</em></p>
<br>
<p>
<a href="http://videolectures.net/chi08_kieras_phc/">Psychology in Human-Computer Interaction</a> by David Kieras<br>shows this frustrates the user with lack of control.</p>
<br>
<p>
<div class="reference_footnote">Image from <a href="https://visualhierarchy.co/blog/wp-content/uploads/2015/09/infinite_scroll.gif">visualhierarchy</a></div></p>
</section><section  data-background="images/infinite-hate.gif" class="vertical-slide">
<p>
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><font color="black"></p>
<br>
<p>
<div class="reference_footnote">Image from <a href="https://dribbble.com/shots/2152555-I-Hate-Infinite-Scroll">Per Vestman@Dribble</a></div><br></font></p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat6</code>: JavaScript page links </div></h2></p>
<br>
<p>
Don't emulate a browser, <em>be</em> the browser! Selenium ex.</p>
<br>
<pre><code class=python>from selenium import webdriver
from selenium.webdriver.common.by import By
driver = webdriver.Firefox()
driver.get('http://www.google.com')

q = driver.find_element(By.NAME, 'q')
q.send_keys('Black Hat Data Wrangling')
q.submit()</code></pre>
</section>
</section><section class="vertical-stack">
<section id="Hack7"  class="vertical-slide">
<p>
<h2><code>BlackHat7</code>: Watermarking</h2>implementation <strong>EASY</strong> : defense <strong>STRONG</strong> : hack-level <strong>SCRIPT-KIDDIE</strong></p>
<br>
<p>
<h4>Easy mode, simple IP protection</h4></p>
<figure>
    <a href="images/watermark_examples/shutterstock1.jpg">
    <img class="" src="images/watermark_examples/shutterstock1.jpg" height="300">
    </a>
    <figcaption>Easy to remove.</figcaption>
    </figure>
<figure>
    <a href="images/watermark_examples/shutterstock2.jpg">
    <img class="" src="images/watermark_examples/shutterstock2.jpg" height="300">
    </a>
    <figcaption>Requires time to remove, not automated.</figcaption>
    </figure>
<br>
<p>
Can watermark non images too! SHOW EXAMPLE.</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat7</code>: Watermarking</h2></div></p>
<br>
<p>
ADD CONTENT!</p>
</section>
</section><section class="vertical-stack">
<section id="Hack8"  class="vertical-slide">
<p>
<h2><code>BlackHat8</code>: Honeypots & Stenography</h2>implementation <strong>HARD</strong> : defense <strong>RIDICULOUS</strong> : hack-level <strong>HOLLYWOOD</strong><br>Stenography: embed data to identify and track IP/credentials.</p>
<br>
<p>
A legal strong-arm strategy, freely give data but track its distribution.</p>
<br>
<p>
Useful to determine ToS violations!</p>
<br>
<p>
Poison the well! Leave fake data buried deep within the dataset!</p>
</section><section   class="vertical-slide">
<p>
<h3>Image stenography</h3>Hide data in the EXIF header (obvious place, easy to remove), <a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">ExifTool</a></p>
<figure>
    <a href="images/honeypot_examples/panda.jpg">
    <img class="" src="images/honeypot_examples/panda.jpg" >
    </a>
    <figcaption><a href="https://flic.kr/p/9eopJm">Kevin Dooley, Flickr</a></figcaption>
    </figure>
<br>
<pre><code class=python>$ identify -verbose panda.jpg 

 Image: panda.jpg
  Format: JPEG (Joint Photographic Experts Group JFIF format)
  ...
  Properties:
    date:create: 2016-01-10T11:58:10-05:00
    exif:ApertureValue: 327680/65536
    exif:ColorSpace: 1
    exif:DateTime: 2009:08:01 08:59:44
    exif:DateTimeOriginal: 2009:07:24 04:17:22
   ...</code></pre>
</section><section   class="vertical-slide">
<p>
<h3>Image stenography</h3>Map post-filter md5sum to user data (not resistant to image changes).<br>Impossible for user to know what is being stored!</p>
<br>
<pre><code class=python>import numpy as np
from scipy.ndimage import imread
from scipy.misc import imsave

jpg = imread(&quot;panda.jpg&quot;)
idx = np.random.uniform(size=jpg.shape) &lt; 0.001
jpg[idx] += np.random.uniform(-2,2, size=idx.sum()).astype(np.uint8)
jpg[jpg&lt;0] = 0
jpg[jpg&gt;255] = 255
imsave(&quot;panda_new.jpg&quot;, jpg)
# Test on command line
# $ md5sum *.jpg
# bd1a44ba2111eb675e78935d4d5cc186  panda.jpg
# 672c6dbf03828ea50a70bc81e19bfd69  panda_new.jpg</code></pre>
<br>
<figure>
    <a href="images/honeypot_examples/panda.jpg">
    <img class="" src="images/honeypot_examples/panda.jpg" >
    </a>
    
    </figure>
<figure>
    <a href="images/honeypot_examples/panda_new.jpg">
    <img class="" src="images/honeypot_examples/panda_new.jpg" >
    </a>
    
    </figure>
</section><section   class="vertical-slide">
<p>
<h3>General stenography</h3></p>
<br>
<p>
Works for any lossy format (mp3, gif, etc...)<br>For tabular data, hide identification in NULL fields that can be easily removed.<br>Perturb date-times by seconds in data records and save the offset.</p>
<br>
<p>
<h3>Honeypots</h3></p>
<br>
<p>
If a bot or persistent downloader is identified, feed them faulty data... ex.<br>Continually degrade image quality sent as function of DL's<br>Remove rows, or return records not found with increasing frequency.</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat8</code>: Honeypots & Stenography </div></h2></p>
<br>
<p>
Download data multiple times from different sources.</p>
<br>
<p>
Run <code>diff</code> commands to suss out data that changes by IP and user.</p>
<br>
<p>
Sanitize data by rejecting fields and entries that change with alternative DLs.</p>
<br>
<p>
Modify image to remove stenography (apply same trick twice!)</p>
</section>
</section><section class="vertical-stack">
<section id="Hack9"  class="vertical-slide">
<p>
<h2><code>BlackHat9</code>: Remove markup metadata</h2>implementation <strong>HARD</strong> : defense <strong>REASONABLE</strong> : hack-level <strong>CORPORATE</strong></p>
<br>
<p>
<h3>Two ways:</h3><h4>1. Break the standard UX design.</h4><h4>2. Remove proper HTML/CSS markup.</h4></p>
<br>
<p>
Organized webpage = Organized data = Easy rip</p>
</section><section   class="vertical-slide">
<p>
Eschew all user design and layer components dynamically.<br>Example: <a href="http://arngren.net/">http://arngren.net/</a></p>
<figure>
    <a href="images/badUX_arngren.png">
    <img class="" src="images/badUX_arngren.png" >
    </a>
    
    </figure>
</section><section   class="vertical-slide">
<p>
Remove markup. You can't rip what you can't see.</p>
<br>
<pre><code class=python>&lt;div class=&quot;author&quot;&gt;
    &lt;div class=&quot;firstname&quot;&gt;Preston &lt;/div&gt;
    &lt;div class=&quot;lastname&quot;&gt; Garvey  &lt;/div&gt;
&lt;div&gt;

&lt;div class=&quot;author&quot;&gt;
    &lt;div class=&quot;firstname&quot;&gt;Piper &lt;/div&gt; 
    &lt;div class=&quot;lastname&quot;&gt; Wright  &lt;/div&gt;
&lt;div&gt;</code></pre>
<br>
<pre><code class=python>&lt;!-- Remove all class and id labels, like this --&gt; 
&lt;div style=&quot;font-weight: bold;&quot;&gt;
Preston Garvey &lt;/br&gt;
Piper Wright
&lt;/div&gt;</code></pre>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat9</code>: Remove markup</div></h2></p>
<br>
<p>
Rare in the wild as this makes web development a nightmare.<br><em>often found when dev's use lazy CMS...</em></p>
<br>
<p>
Removing meta data slows users down, but syntax rules can be written per item:</p>
<pre><code class=python>html = '''
&lt;div style=&quot;font-weight: bold;&quot;&gt;
Preston Garvey &lt;/br&gt;
Piper Wright
&lt;/div&gt;'''

import bs4
soup = bs4.BeautifulSoup(html,'lxml')
text = soup.div.text
names = text.strip().split('\n')

keys = &quot;firstname&quot;, &quot;lastname&quot;
data = [dict(zip(keys,x.split())) for x in names]

print data
# [{'lastname': u'Garvey', 'firstname': u'Preston'}, {'lastname': u'Wright', 'firstname': u'Piper'}]</code></pre>
</section>
</section><section class="vertical-stack">
<section id="Hack10"  class="vertical-slide">
<p>
<h2><code>BlackHat10</code>: HTML obfuscation</h2>implementation <strong>EASY</strong> : defense <strong>REASONABLE</strong> : hack-level <strong>SCRIPT-KIDDIE</strong></p>
<br>
<p>
Encode everything with HTML character codes and insert random benign HTML.</p>
<br>
<p>
Start with this:</p>
<pre><code class=python>This is a string of text</code></pre>
<p>
Encode to this:</p>
<pre><code class=python>&amp;#84;&amp;#104;&amp;#105;&amp;#115;&amp;#32;&amp;#105;&amp;#115;&amp;#32;&amp;#97;&lt;u&gt;&lt;/u&gt;&amp;#32;&amp;#115;
&lt;i&gt;&lt;/i&gt;&amp;#116;&amp;#114;&amp;#105;&lt;u&gt;&lt;/u&gt;&amp;#110;&amp;#103;&lt;i&gt;&lt;/i&gt;&amp;#32;&lt;u&gt;&lt;/u&gt;&amp;#111;&amp;#102;&amp;#32;&amp;#116;&amp;#101;&amp;#120;&amp;#116;</code></pre>
<p>
'View Source' shows this:</p>
<pre><code class=python>&lt;p&gt;&amp;#84;&amp;#104;&amp;#105;&amp;#115;&amp;#32;&amp;#112;&amp;#97;&amp;#103;&amp;#101;
&amp;#32;&amp;#105;&amp;#115;&lt;i&gt;&lt;/i&gt;&amp;#32;&lt;u&gt;&lt;/u&gt;&amp;#109;&amp;#101;&amp;#97;&amp;#110;&lt;b&gt;&lt;/b&gt;</code></pre>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat10</code>: HTML obfuscation </div></h2></p>
<br>
<p>
Use the <a href="http://www.seleniumhq.org/projects/webdriver/">Selenium Web Driver</a></p>
<br>
<ol><li>1. Create a headless web browser</li>
<li>2. Open the page</li>
<li>3. Take a screenshot of the page</li>
<li>4. Use OCR to extract the text from the screenshot</li></ol>
<p>
<em>or</em></p>
<ol><li>1. Capture the entire page (curl, etc.)</li>
<li>2. Decode the HTML characters using <a href="http://www.crummy.com/software/BeautifulSoup/">BeautifulSoup4</a></li></ol>
</section>
</section><section class="vertical-stack">
<section id="Hack11"  class="vertical-slide">
<p>
<h2><code>BlackHat11</code>: Serving HTML as PDF</h2>implementation <strong>HARD</strong> : defense <strong>STRONG</strong> : hack-level <strong>CORPORATE</strong></p>
<br>
<p>
<h3>Convert all Text to PDF</h3>Use <a href="http://phantomjs.org/">PhantomJS</a>, <a href="http://wkhtmltopdf.org/">Wkhtmltopdf</a> or <a href="http://pdfkit.org/">PDFKit</a> (node.js)</p>
<br>
<p>
Eschew style conventions and use multi-columns!</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat11</code>: Serving HTML as PDF </div></h2></p>
<br>
<p>
Use OCR to extract text and images from the text<br><em>or</em><br><a href="http://tabula.technology/">Tabula</a> to extract tabular data</p>
</section>
</section><section class="vertical-stack">
<section id="Hack12"  class="vertical-slide">
<p>
<h2><code>BlackHat12</code>: Text remapping</h2>implementation <strong>WTF</strong> : defense <strong>RIDICULOUS</strong> : hack-level <strong>HOLLYWOOD</strong></p>
<br>
<p>
Alter text from visual display:</p>
<br>
<p>
<h3>Javascript</h3><h3>Hidden spans</h3><h3>Font remapping</h3></p>
</section><section   class="vertical-slide">
<p>
<h2>Javascript text manipulation</h2></p>
<br>
<p>
Alter the text as it is copied. JSfiddle <a href="http://jsfiddle.net/jp6nhmxf/">example</a></p>
<br>
<pre><code class=python>function addLink() {
    //Get the selected text and append the extra info
    var selection = window.getSelection(),
        pagelink = '&lt;br /&gt;&lt;br /&gt; Read more at: ' + document.location.href,
        copytext = selection + pagelink,
        newdiv = document.createElement('div');

    //hide the newly created container
    newdiv.style.position = 'absolute';
    newdiv.style.left = '-99999px';

    //insert the container, fill it with the extended text, and define the new selection
    document.body.appendChild(newdiv);
    newdiv.innerHTML = copytext;
    selection.selectAllChildren(newdiv);

    window.setTimeout(function () {
        document.body.removeChild(newdiv);
    }, 100);
}
document.addEventListener('copy', addLink);</code></pre>
</section><section   class="vertical-slide">
<p>
<h2>Hidden spans</h2></p>
<br>
<p>
simple text below right?<h2><p class="codeblock">T<span style="position: absolute; left: -5000px; top: -5000px">gCRT3Qg3</span>R<span style="position: absolute; left: -5000px; top: -5000px">T7SQNdsF</span>A<span style="position: absolute; left: -5000px; top: -5000px">TBsh8T3T</span>V<span style="position: absolute; left: -5000px; top: -5000px">WKaKeTMg</span>I<span style="position: absolute; left: -5000px; top: -5000px">ayRwzhur</span>S<span style="position: absolute; left: -5000px; top: -5000px">tNVKkXZV</span></p></h2><div class="fragment">copy and paste transforms<br><code>TRAVIS</code> to <code>TgCRT3Qg3RT7SQNdsFATBsh8T3TVWKaKeTMgIayRwzhurS</code></p>
<pre><code class=python> &lt;p class=&quot;codeblock&quot;&gt;
   T
   &lt;span style=&quot;position: absolute; left: -100px; top: -100px&quot;&gt;gCRT3Qg3&lt;/span&gt;
   R
   &lt;span style=&quot;position: absolute; left: -100px; top: -100px&quot;&gt;T7SQNdsF&lt;/span&gt;
   A
   &lt;span style=&quot;position: absolute; left: -100px; top: -100px&quot;&gt;TBsh8T3T&lt;/span&gt;
   V
   &lt;span style=&quot;position: absolute; left: -100px; top: -100px&quot;&gt;WKaKeTMg&lt;/span&gt;
   I
   &lt;span style=&quot;position: absolute; left: -100px; top: -100px&quot;&gt;ayRwzhur&lt;/span&gt;
   S
   &lt;span style=&quot;position: absolute; left: -100px; top: -100px&quot;&gt;tNVKkXZV&lt;/span&gt;
 &lt;/p&gt;</code></pre>
<br>
<p>
Any data payload can be inserted here (e.g. copyright claims, point of origin, etc...)<br></div></p>
</section><section   class="vertical-slide">
<p>
<h2>Font remapping</h2></p>
<br>
<p>
Render document to PDF and remap fonts <em>per document</em> for protected data.<h3>Example: <a href="images/font_remapping.pdf">font_remapping.pdf</a></h3></p>
<br>
<p>
WTH? How does it work?</p>
<blockquote>A PDF is a collection of symbols drawn on a page. Draw `c` here, draw `a` there, etc. A PDF reader only knows what a letter is because it maps to a specific character code in the font. Simply create a new font that lies about its mapping.</blockquote>
<br>
<p>
Multiple fonts can be used to improve the "encryption" process,<br>one font per character gives a one-time pad!</p>
</section><section   class="vertical-slide">
<p>
<div class="whitehat"><h2><code>WhiteHat12</code>: Text remapping </div></h2></p>
<br>
<p>
For <strong>Javascript</strong> remapping use a headless browser. For <strong>hidden spans</strong>, learn and write custom rules to remove the offending page elements. For <strong>font remapping</strong>...<div class="fragment"><br><br>Throw money and humans at it: <a href="https://www.mturk.com/mturk/welcome">Mechanial Turk</a></p>
<figure>
    <a href="images/baby_rain.gif">
    <img class="transparent_image" src="images/baby_rain.gif" height="420px">
    </a>
    
    </figure>
<figure>
    <a href="images/monkey.gif">
    <img class="transparent_image" src="images/monkey.gif" height="420px">
    </a>
    
    </figure>
<p>
</div></p>
</section>
</section><section class="vertical-stack">
<section   class="vertical-slide">
<p>
<h1>Thanks, you!</h1></p>
<br>
<p>
Got any more Black Hat Hacks? Let us know!<h5><code>#blackhatdata</code> / <a href="https://twitter.com/metasemantic">@metasemantic</a> / <a href="https://twitter.com/rdempsey">@rdempsey</a></h5></p>
</section>
</section>
    </div></div>

    <script src="reveal.js/lib/js/head.min.js"></script>
    <script src="reveal.js/js/reveal.js"></script>

    <script>
      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
      overview: true, height: 900, keyboard: {37: 'prev', 39: 'next'}, touch: true, hideAddressBar: true, rollingLinks: false, mouseWheel: true, controls: false, width: 1200, viewDistance: 3, rtl: false, progress: true, fragments: true, autoSlide: 0, autoSlideStoppable: true, backgroundtransition: "default", transitionSpeed: "default", slideNumber: true, center: true, embedded: true, transition: "default", maxScale: 1.2, minScale: 0.2, previewLinks: false, margin: 0.05, loop: false, history: true, 
      
      theme: Reveal.getQueryHash().theme, 
      // available themes are in reveal.js/css/theme

      // Optional libraries used to extend on reveal.js
      dependencies: [ { src: 'reveal.js/lib/js/classList.js', condition: function() { 
    return !document.body.classList; } },

{ src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { 
    return !!document.querySelector( '[data-markdown]' ); } },

{ src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { 
    return !!document.querySelector( '[data-markdown]' ); } },

{ src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: 
  function() { hljs.initHighlightingOnLoad(); } },

{ src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: 
  function() { return !!document.body.classList; } },
 ]

      });
    </script>

  </body>
</html>
